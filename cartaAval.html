<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
        .bordeado {
            border: black 1px solid;
        }

        .biz {
            border-left: black 1px solid;
        }

        .bde {
            border-right: black 1px solid;
        }

        .btop {
            border-top: black 1px solid;
        }

        .bajo {
            border-bottom: black 1px solid;
        }

        .contenedor {
            width: 1000px;

        }

        .tcontenedor {
            width: 100%;
        }

        .textoCenter {
            text-align: center;
        }

        .texto12 {
            font-size: 12px;
        }

        .texto10 {
            font-size: 10px;
        }

        .doble {
            height: 40px;
        }

        .simple {
            height: 20px;
        }

        .fondo {
            background-color: #979a93;
        }

        .junta {
            border-collapse: collapse;
        }
    </style>
</head>
<body>
<center>
    <div class="contenedor">

                                      <table border="0">
                                        <tr>
                                          <!--td width="15%" valign="top"><img  style="width: 90px;height: 90px; margin-left: 0px" class="img-responsive file-path-wrapper-pre-view" src="images/logo_ipsfa.png" id="_imgescudo"/><BR>
                                          <img  style="width: 90px;height: 35px; margin-left: 0px" class="img-responsive file-path-wrapper-pre-view" src="images/fondo_ipsfa.png" id="_imgescudo"/-->

                                          </td>
                                            <td style="width: 38%"><img src="images/lg.png" style="float: left">
                                            <center><p style="font-size: 8px"> REPUBLICA BOLIVARIANA DE VENEZUELA <br> MINISTERIO DEL PODER
                        POPULAR PARA LA DEFENSA<br>VICEMINISTERIO DE SERVICIOS<br>DIRECCIÓN GENERAL DE EMPRESAS Y SERVICIOS<br>
                    INSTITUTO DE PREVINSIÓN SOCIAL DE LA FUERZA ARMADA<br>
                    GERECIA DE BIENESTAR Y SEGURIDAD</p></center>
                                            </td>
                                        </tr>

                                      </table>
                                       <center><h3>CARTA AVAL</h3></center>
                                       <table border="0">
                                          <td width="70%" class="membrete">
                                              <left>
                                                      SEÑORES: <BR>
                                                      CENTRO CLINICO DE MATERNIDAD<BR>
                                                      LEOPOLDO AGUERREVERE<BR>
                                                      UNIDAD MASTOLOGIA<BR><BR><BR>

                                              </left></td>
                                        </table>
                                      <!--div class="row">
                                        <div  class="col-sm-12 col-md-12 cuerpo_constancia" align="justify"-->
                                        Por medio de la presente, hacemos constar que el (la) cuidadana: (NOMBRE DEL BENEFICIARIO(A), titular de la cédula de identidad Nº (CI) se encuentra afiliada a este instituto quien es miembro de la Fuerza Armada Nacional Bolivariana.
                                        <br><br>
                                        Por lo anteriormente expuesto, este Instituto se compromete a cancelar por concepto de (EXAMEN SELECCIONADO) la suma de (MONTO CARGADO EN LETRAS Y CIFRA) que representa un 70% del costo total del exámen y el(la) afiliado(a) el 30% restante.
                                        <br><br>
                                        Asi mismo agradecemos, que cualquier información requerida para la tramitación del presente caso, comunicarse con nuestros telefonos directos: (0212)-6931408-(0212)-6092545, Departamento de Cuidado Integral de la Salud.
                                        <br><br>
                                        <center>Atentamente</center>
                                        <!--/div>
                                      </div-->
                                      <br>

                                      <table border="0">
                                        <tr>
                                          <td width="50%" class="control-label">
                                            <center><h3><br>
                                              <label id="lblnombrePI"> </label><BR>
                                              <label id="lblgradoPIF"> </label><br>
                                              GERENTE DE BIENESTAR Y SEGURIDAD SOCIAL
                                              </h3></center>
                                          </td>
                                        </tr>
                                        <tr>
                                          <td colspan="3" class="footer">
                                            <center><br>
                                            </center>
                                          </td>
                                        </tr>
                                      </table>

                                          </td></tr>
                                        </table>









    </div>

    <div id="boton">
        <br>
        <input type="button" value="Imprimir" onclick="imprimir()">
    </div>
</center>

</body>
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/formato/numeral.js"></script>

<script src="js/utilidad.js"></script>
<script src="js/militar.js"></script>
<script src="js/config.js"></script>
<script src="js/controlador.js"></script>
<script>
    let pos = '';
    $(function () {
        numeral.register('locale', 'es-es', {
            delimiters: {
                thousands: '.',
                decimal: ','
            },
            abbreviations: {
                thousand: 'k',
                million: 'mm',
                billion: 'b',
                trillion: 't'
            },
            ordinal: function (number) {
                var b = number % 10;
                return (b === 1 || b === 3) ? 'er' :
                    (b === 2) ? 'do' :
                        (b === 7 || b === 0) ? 'mo' :
                            (b === 8) ? 'vo' :
                                (b === 9) ? 'no' : 'to';
            },
            currency: {
                symbol: 'BS'
            }
        });
        numeral.locale('es-es');
        $.obtener = function (key) {
            key = key.replace(/[\[]/, '\\[');
            key = key.replace(/[\]]/, '\\]');
            var pattern = "[\\?&]" + key + "=([^&#]*)";
            var regex = new RegExp(pattern);
            var url = unescape(window.location.href);
            var results = regex.exec(url);
            if (results === null) {
                return null;
            } else {
                return results[1];
            }
        };
        var id = $.obtener("id");
        pos = $.obtener("pos");
        console.log(id);
        Buscar(id);
    });

    function imprimir() {
        $('#boton').html('');
        window.print();
        window.close();
    }

    function Buscar(id) {
        console.log(militar);
        if (id != undefined) {
            $("#_cedula").val(id);
        }
        if ($("#_cedula").val() == "") {
            return false;
        }

        var url = Conn.URL + "militar/crud/" + id;
        var request = CargarAPI({
            sURL: url,
            metodo: 'GET',
            valores: '',
            Objeto: militar
        });

        request.then(function (xhRequest) {

            militar = JSON.parse(xhRequest.responseText);
            llenar(id);

        });

        var request2 = CargarAPI({
            sURL: 'js/proveedores.js',
            metodo: 'GET',
            valores: '',
        });

        request2.then(function (xhRequest) {

            lstProveedores = JSON.parse(xhRequest.responseText);

        });

        //CargarAPI(url, "GET", "", militar);


    }

    function llenar(formato) {
        if (formato != undefined) {

        }
        if (militar.Persona != undefined) {
            var ncompleto = militar.Persona.DatoBasico.nombreprimero + " " + militar.Persona.DatoBasico.apellidoprimero;
            $("#lblnombre").text(ncompleto);

            $("#lblcomponente").text(militar.Componente.descripcion);

            $("#lblgrado").text(militar.Grado.descripcion);

            $("#lblcedula").text(militar.Persona.DatoBasico.cedula);

            crearLista();

            var estcivil = Util.GenerarEstadoCivil(militar.Persona.DatoBasico.estadocivil, militar.Persona.DatoBasico.sexo);

            $("#lblestadocivil").text(estcivil);

            $("#lblsituacion").text(Util.ConvertirSitucacion(militar.situacion));


            if (militar.Persona.Direccion != undefined) {
                var defestados = sessionStorage.getItem("ipsfaEstado");
                console.log(defestados);
                var DIR = militar.Persona.Direccion[0];
                Estados.ObtenerEstados();
                var rirec = DIR.estado + ", " + DIR.ciudad + ", municipio " + DIR.municipio + ", parroquia " + DIR.parroquia + ", Av/Calle " + DIR.calleavenida + ", casa/apt " + DIR.casa + "|" + DIR.apartamento
                $("#lbldireccion").text(rirec);
            }

        } else {
            alert("Cedula no se encuentra registrada como militar dentro del sistema");
        }
    }

    function crearLista() {
        if (pos == null) {
            pos = militar.CIS.ServicioMedico.Programa.Reembolso.length;
            pos--;
        }
        console.log(pos);
        var reem = militar.CIS.ServicioMedico.Programa.Reembolso[pos];
        console.log(reem);
        $("#lblnsolicitud").text(reem.numero);
        $("#lblfecha").text(Util.ConvertirFechaHumana(reem.fechacreacion));
        $("#lblbanco").text(reem.CuentaBancaria.institucion);
        $("#lblcuenta").text(reem.CuentaBancaria.cuenta);
        $("#lbltipoc").text(reem.CuentaBancaria.tipo);
        $("#lblmontot").text(numeral(parseFloat(reem.montosolicitado)).format('0,0.00'));
        var concep = militar.CIS.ServicioMedico.Programa.Reembolso[pos];
        var fila = "";
        $.each(concep.Concepto, function () {
            var bene = this.afiliado.split("-");
            var mntformato = numeral(parseFloat(this.DatoFactura.monto)).format('0,0.00');
            fila += "<tr><td>" + bene[0] + "</td><td>" + bene[1] + "</td><td>" + this.descripcion + "</td><td style=\"text-align: right\">" + mntformato + "</td><td></td></tr>";
        });
        $("#cuerpoConceptos").html(fila);
    }
</script>
</html>
